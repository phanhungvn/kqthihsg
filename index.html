<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V√≤ng Quay HSG Qu·∫£ng Tr·ªã - Auto</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        body {
            background: #0f0c29;
            background: linear-gradient(to bottom, #24243e, #302b63, #0f0c29);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; margin: 0; font-family: 'Arial', sans-serif; overflow: hidden; color: white;
        }

        .header { text-align: center; margin-bottom: 20px; }
        .header h1 { color: #f1c40f; text-shadow: 0 0 15px rgba(241, 196, 15, 0.6); margin: 5px; }

        /* Khung ch·ª©a v√≤ng quay */
        .wheel-box {
            position: relative; width: 450px; height: 450px;
            border: 15px solid #222; border-radius: 50%;
            box-shadow: 0 0 50px rgba(0,0,0,0.8), inset 0 0 20px rgba(0,0,0,0.5);
        }

        /* M≈©i t√™n ƒë·ª©ng y√™n ·ªü tr√™n c√πng */
        .pointer {
            position: absolute; top: -25px; left: 50%; transform: translateX(-50%);
            width: 40px; height: 50px; background: #ff4757;
            clip-path: polygon(50% 100%, 0 0, 100% 0); z-index: 100;
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.5));
        }

        canvas { width: 100%; height: 100%; border-radius: 50%; transition: transform 4s cubic-bezier(0.1, 0, 0.2, 1); }

        /* N√∫t quay ·ªü t√¢m */
        .spin-trigger {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 80px; height: 80px; background: white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            z-index: 101; cursor: pointer; border: 4px solid #f1c40f;
            font-weight: bold; color: #333; box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        /* Hi·ªán t√™n ng∆∞·ªùi v·ª´a tr√∫ng */
        #status {
            margin-top: 25px; height: 40px; font-size: 1.5rem;
            font-weight: bold; color: #2ed573; text-shadow: 0 0 10px rgba(46, 213, 115, 0.4);
        }

        /* Modal k·∫øt qu·∫£ cu·ªëi c√πng */
        #final-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 200; align-items: center; justify-content: center;
        }
        .modal-card {
            background: white; color: #333; padding: 40px; border-radius: 20px;
            text-align: center; max-width: 500px; animation: scaleUp 0.5s ease;
        }
        @keyframes scaleUp { from { transform: scale(0.7); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .winner-list { font-size: 1.8rem; color: #e74c3c; font-weight: bold; margin: 20px 0; }
    </style>
</head>
<body>

    <div class="header">
        <h1>TUY·ªÇN CH·ªåN HSG TIN H·ªåC 9</h1>
        <p>T·ªânh Qu·∫£ng Tr·ªã - Ni·ªÅm tin chi·∫øn th·∫Øng</p>
    </div>

    <div class="wheel-box">
        <div class="pointer"></div>
        <canvas id="canvas" width="500" height="500"></canvas>
        <div class="spin-trigger" id="spinBtn">QUAY</div>
    </div>

    <div id="status">Nh·∫•n "QUAY" ƒë·ªÉ b·∫Øt ƒë·∫ßu ch·ªçn 3 b·∫°n!</div>

    <div id="final-overlay">
        <div class="modal-card">
            <h2 style="color: #f39c12;">üéä CH√öC M·ª™NG ƒê·ªòI TUY·ªÇN üéä</h2>
            <div id="final-names" class="winner-list"></div>
            <p>ƒê√£ xu·∫•t s·∫Øc l·ªçt v√†o ƒë·ªôi tuy·ªÉn thi HSG c·∫•p t·ªânh l·ªõp 9 m√¥n Tin h·ªçc T·ªânh Qu·∫£ng Tr·ªã.</p>
            <p style="color: #7f8c8d; font-style: italic; border-top: 1px solid #eee; padding-top: 15px;">
                Ch√∫c c√°c b·∫°n c√≤n l·∫°i lu√¥n gi·ªØ v·ªØng ƒëam m√™ v√† th√†nh c√¥ng r·ª±c r·ª° tr√™n con ƒë∆∞·ªùng v√†o l·ªõp 10!
            </p>
            <button onclick="location.reload()" style="padding: 10px 20px; cursor: pointer; border-radius: 10px; border: none; background: #3498db; color: white;">Quay l·∫°i</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spinBtn');
        const statusText = document.getElementById('status');
        
        const names = ["Phan H∆∞ng", "Thi√™n Ph√∫c", "ƒêo√†n Huy", "Gia B·∫£o", "ƒê·∫°i Quang", "B√πi Khang"];
        const colors = ["#e74c3c", "#3498db", "#2ecc71", "#f1c40f", "#9b59b6", "#e67e22"];
        const winners = ["Phan H∆∞ng", "ƒêo√†n Huy", "ƒê·∫°i Quang"];
        
        let currentRotation = 0;
        let step = 0;

        function draw() {
            const arc = (2 * Math.PI) / names.length;
            ctx.clearRect(0,0,500,500);
            for (let i = 0; i < names.length; i++) {
                const angle = i * arc;
                ctx.beginPath();
                ctx.fillStyle = colors[i];
                ctx.moveTo(250, 250);
                ctx.arc(250, 250, 250, angle, angle + arc);
                ctx.fill();
                ctx.strokeStyle = "rgba(255,255,255,0.2)";
                ctx.stroke();

                ctx.save();
                ctx.translate(250, 250);
                ctx.rotate(angle + arc / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = "white";
                ctx.font = "bold 20px Arial";
                ctx.fillText(names[i], 230, 10);
                ctx.restore();
            }
        }
        draw();

        async function startFullProcess() {
            spinBtn.style.display = 'none';
            
            for (let i = 0; i < 3; i++) {
                const nameToHit = winners[i];
                statusText.innerText = `ƒêang t√¨m ki·∫øm th√†nh vi√™n th·ª© ${i+1}...`;
                
                await spinToName(nameToHit);
                
                statusText.innerText = `Ch√∫c m·ª´ng: ${nameToHit}!`;
                confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
                
                // Ngh·ªâ 2 gi√¢y tr∆∞·ªõc khi quay ti·∫øp
                if (i < 2) await new Promise(r => setTimeout(r, 2000));
            }
            
            setTimeout(showFinalResult, 1500);
        }

        function spinToName(name) {
            return new Promise(resolve => {
                const idx = names.indexOf(name);
                const sectionAngle = 360 / names.length;
                
                // T√≠nh to√°n g√≥c: M≈©i t√™n ·ªü v·ªã tr√≠ 270 ƒë·ªô (ƒë·ªânh tr√™n c√πng)
                // Ph·∫£i xoay sao cho √¥ idx n·∫±m ·ªü v·ªã tr√≠ 270 ƒë·ªô
                const extraSpins = (step + 1) * 360 * 5; // Quay th√™m v√≤ng ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng
                const stopAngle = 270 - (idx * sectionAngle) - (sectionAngle / 2);
                
                currentRotation = extraSpins + stopAngle;
                canvas.style.transform = `rotate(${currentRotation}deg)`;
                
                step++;
                setTimeout(resolve, 4500); // ƒê·ª£i quay xong
            });
        }

        function showFinalResult() {
            document.getElementById('final-overlay').style.display = 'flex';
            document.getElementById('final-names').innerText = winners.join(' - ');
            
            // Ph√°o hoa li√™n h·ªìi
            var end = Date.now() + (5 * 1000);
            (function frame() {
              confetti({ particleCount: 3, angle: 60, spread: 55, origin: { x: 0 } });
              confetti({ particleCount: 3, angle: 120, spread: 55, origin: { x: 1 } });
              if (Date.now() < end) requestAnimationFrame(frame);
            }());
        }

        spinBtn.addEventListener('click', startFullProcess);
    </script>
</body>
</html>
